@startuml
Title Symmetric Encryption
[*] --right> Idle
Idle --> Operate
Idle: N/A
Operate --> Idle
note right of Idle: Transition to operate\nupon receiving inputs:\n  Key\n  Payload\n  PayloadSizeInBytes
Operate: Outputs:\n  PowerConsumed\n  OutputSizeInBytes\n  EcnryptedPayload 

@enduml

==========================================================================================================

@startuml
Title AuthenticationManager: Kerberos
[*] --down> Idle

Idle --> EncryptKdcSessionRequest: ApplicationName\nSecurityLevel(1)\nDestinationName 
Idle: N/A

Idle -right-> AuthenticateUser: ApplicationName\nSecurityLevel(2)\nDestinationName
AuthenticateUser: Outputs:\n  AuthenticationType

AuthenticateUser -down-> EncryptKdcSessionRequest: AuthenticationResult

EncryptKdcSessionRequest: Outputs:\n  OutputSizeInBytes
EncryptKdcSessionRequest -down-> InitKdcSession: EncryptedPayload


InitKdcSession: Outputs:\n  KdcSessionRequest
InitKdcSession --> DecryptKdcSessionKey: \n  PayloadType:Tgt\n  PayloadSize
  

DecryptKdcSessionKey: Outputs:\n  OutputSizeInBytes\n  PlainTextPayload
DecryptKdcSessionKey --> EncryptRecipientSessionRequest: Tgt\nKdcSessionKey

EncryptRecipientSessionRequest: Outputs:\n  EncryptedPayload
EncryptRecipientSessionRequest -left-> RequestRecipientSession: EncryptedPayload

RequestRecipientSession: Outputs:\n  EncryptedPayload\n  PayloadSizeInBytes

RequestRecipientSession -up-> DecryptRecipientSessionKey: RecipientSessionKey\nPayloadSizeInBytes
DecryptRecipientSessionKey: Outputs:\n  PlayTextPayload\n  PayloadSizeInBytes

DecryptRecipientSessionKey -up-> EncryptRecipientRequest: RecipientSessionKey
EncryptRecipientRequest: Outputs:\n  EncryptedPayload\n  PayloadSizeInBytes
EncryptRecipientRequest -up-> SendMessage: EncryptedRecipientRequest
SendMessage -right-> Idle

@enduml

@startuml
Title AuthenticationManager: PKI
[*] --down> Idle
Idle -right-> GetCertificate: ApplicateionName\nSecurityLevel(3)\nReceiverName
GetCertificate: Outputs:\n  Recipient ID

GetCertificate -up-> DecryptCertificate: Encrypted hash + Certificate\nCA Public Key 
DecryptCertificate: Outputs: \n  Encrypted hash + Certificate

DecryptCertificate -up-> GetCertificateHash: Receiver certificate
GetCertificateHash: Outputs:\n  Certificate hash

GetCertificateHash -up-> EncryptAsymmReceiverRequest: Message\nReceiver Public Key
EncryptAsymmReceiverRequest: Outputs: \n  Encrypted Message

EncryptAsymmReceiverRequest -left-> GetMessageHash: Message
GetMessageHash: Outputs:\n  Message Hash
GetMessageHash -down-> EncryptAsymmHash: Hash 
EncryptAsymmHash: Outputs:\n Encrypted Hash

EncryptAsymmHash --> SendMessage: Encrypted Hash\nEncrypted Message 


SendMessage --> Idle
@enduml



==========================================================================================================

@startuml
Title Power Collector
[*] --right> Idle
Idle: TotalPowerConsumed
Idle --> Idle: PowerConsumed
@enduml

==========================================================================================================

@startuml
Title Authentication Factor Manager
[*] --right> Idle
Idle --> GetAuthentication: AuthenticationType
GetAuthentication: PowerConsumed\nAuthenticationResult
GetAuthentication --> Idle
@enduml


==========================================================================================================

